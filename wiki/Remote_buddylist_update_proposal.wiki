Via jtorchat, grab bl.txt from a remote location, and merge with own buddies.

These codes assumes that you remember to 'import' the relevant classes. Eclipse will help with that.

BuddyList.java - Method added (work in progress):


{{{
	/*
	 *  REMOTE BUDDY LOAD VIA TOR
	 * */
	public static void loadBuddiesRemote() throws FileNotFoundException {
		
		// Don't load if no url was specified
		if ( remote_bl_URL == null ) {
			Logger.log(Logger.INFO, "BuddyList loadBuddiesRemote", "No remote buddylist specified. Skipping remote load.");
			return;
		}
		
		/*
		 *  RETREIVE REMOTE FILE VIA PROXY TO SCANNER OBJECT
		 * */
		Logger.log(Logger.INFO, "BuddyList loadBuddiesRemote", "Retreiving remote buddies");
		Scanner s = null ;
		try {
		    // Create a URL for the desired page
		    URL url = new URL("example.com");
		    URLConnection conn = url.openConnection(new Proxy(Proxy.Type.SOCKS, new InetSocketAddress("127.0.0.1", Config.SOCKS_PORT)));
			s = new Scanner( new InputStreamReader( conn.getInputStream() ) );
		} catch (IOException e) {
		}
		
		
		/*
		 *  PROCESS FILE AND MERGE BUDDY
		 * */
		Logger.log(Logger.INFO, "BuddyList loadBuddiesRemote", "Processing remote buddies");
		Random r = new Random();
		while (s.hasNextLine()) {
			String l = s.nextLine();
			// from 0 to 16 is address, 17 onwards is name
			if (buds.containsKey(l.substring(0, 16)))
				try {
					buds.remove(l.substring(0, 16)).disconnect();
				} catch (IOException e) {
					System.err.println("Error disconnecting buddy: " + e.getLocalizedMessage());
				}
			if (l.length() > 16) {
				Buddy b = new Buddy(l.substring(0, 16), l.substring(17)); //.connect();
				b.reconnectAt = System.currentTimeMillis() + 15000 + r.nextInt(30000);
				if (l.toCharArray()[16] == '!')
					b.overrideName = true;
			} else
				new Buddy(l.substring(0, 16), null).reconnectAt = System.currentTimeMillis() + 15000 + r.nextInt(30000); //.connect();
		}
		
	}
}}}

---

BuddyList.java - hold location of remote buddylist file

{{{
	public static String remote_bl_URL; // = "example.com/bl.txt";
}}}

----

Under every (in config.java)
{{{
		TCPort.profile_name = assign("profile_name", null, prop);
		TCPort.profile_text = assign("profile_text", null, prop);
}}}

add this string

{{{

		BuddyList.remote_bl_URL = assign("remote_buddylist_url", null, prop);

}}}